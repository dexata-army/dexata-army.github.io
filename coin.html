<!DOCTYPE HTML>
<html>
	<head>
		<title>Dexata - coin</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="stylesheet" href="assets/css/pagestyle.css" />
		<link rel="stylesheet" href="assets/css/print.css" />
		<link rel="icon" type="image/svg" href="images/logo.png">
		
		<!-- Scripts -->
		<script src="assets/js/params.js"></script>
		<script src="assets/js/sleep.js"></script>
		<script src="assets/js/wallet.js"></script>
		<script src="assets/js/watchlist.js"></script>
		<script src="assets/js/apex-charts/apexcharts.min.js"></script>
		<script src="assets/js/crypto-js/crypto-js.js"></script>
		
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/jquery.dropotron.min.js"></script>
		<script src="assets/js/jquery.scrollex.min.js"></script>
		<script src="assets/js/jquery.scrolly.min.js"></script>
		
		<!-- https://printjs.crabbly.com/ -->
		<script src="assets/js/print.js"></script>
		
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-D70JLR4EJM"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());
		
		  gtag('config', 'G-D70JLR4EJM');
		</script>

		<script>
			var user = "guest";
		
			if(localStorage.getItem('username'))
				user = localStorage.getItem('username');
			else if(sessionStorage.getItem('username'))
				user = sessionStorage.getItem('username');
		
			function logout()
			{
				localStorage.removeItem('no_dexata_tabs');
				localStorage.removeItem('last_load_time');
				localStorage.removeItem('last_seen');
				localStorage.removeItem('username');
				sessionStorage.removeItem('username');
				localStorage.removeItem('password');
				sessionStorage.removeItem('password');
				//location.reload();
			}
		
			function check_for_logout(username)
			{
				sleep(2000).then(() => { 
					if((!sessionStorate.getItem('username') && !localStorage.getItem('username')) || 
						(sessionStorage.getItem('username') != username && localStorage.getItem('username') != username))
						location.reload();
					else
						check_for_logout(username);
				});
			}
		
			var session_timeout_sec = localStorage.getItem(user + '-session_timeout')*60;
		
			if(session_timeout_sec != undefined && session_timeout_sec > 0)
			{
				if(sessionStorage.getItem('username') || localStorage.getItem('username'))
				{
					var curr_time = Math.round((new Date()).getTime() / 1000);
		
					//checks last page load time
					if(localStorage.getItem("last_load_time"))
					{
						if(curr_time - localStorage.getItem("last_load_time") > session_timeout_sec)
						{
							logout();
							location.reload();
						}
						else
							localStorage.setItem("last_load_time", curr_time);
					}
					else
					{
						logout();
						location.reload();
					}
				}
			}
		
			if(sessionStorage.getItem("username") && !localStorage.getItem("username"))
			{
				var curr_time = Math.round((new Date()).getTime() / 1000);
				if(!localStorage.getItem("last_seen") ||
				     curr_time - localStorage.getItem("last_seen") > 2)
				{
					logout();
					location.reload();
				}
				else
				{
					localStorage.setItem("no_dexata_tabs", 0);
					localStorage.setItem("username", sessionStorage.getItem("username"));
					localStorage.setItem("password", sessionStorage.getItem("password"));
				}
			}
			else if(!sessionStorage.getItem("username") && localStorage.getItem("username"))
			{
				sessionStorage.setItem("username", localStorage.getItem("username"));
				sessionStorage.setItem("password", localStorage.getItem("password"));
			}
		
			var load_host = window.location.hostname;
			if(localStorage.getItem("username"))
			{
				//updates number of dexata tabs open
				if(localStorage.getItem('no_dexata_tabs') != undefined &&
					localStorage.getItem('no_dexata_tabs') >= 0)
					localStorage.setItem('no_dexata_tabs', parseFloat(localStorage.getItem('no_dexata_tabs'))+1);
				else
					localStorage.setItem('no_dexata_tabs', 1);
		
				window.addEventListener('beforeunload', function (e) {
					if(localStorage.getItem('no_dexata_tabs'))
					{
					    localStorage.setItem('no_dexata_tabs', parseFloat(localStorage.getItem('no_dexata_tabs'))-1);
		
					    if(localStorage.getItem('no_dexata_tabs') == 0)
					    {
					    	localStorage.removeItem('no_dexata_tabs');
					    	localStorage.removeItem('username');
					    	localStorage.removeItem('password');
					    }
					}
					else
					{
						sessionStorage.removeItem('username');
						sessionStorage.removeItem('password');
					}
				});
		
				//reloads page if user has logged out
				$(document).ready(function(){
					check_for_logout(localStorage.getItem('username'));
				});
			}
		
			window.addEventListener("pageshow", function (event) {
				var historyTraversal = event.persisted || 
				                     ( typeof window.performance != "undefined" && 
				                          window.performance.navigation.type === 2 );
				if(historyTraversal &&
					sessionStorage.getItem('username') &&
					curr_time - localStorage.getItem('last_seen') > 2)
				{
					// Handle page restore.
					window.location.reload();
				}
			});
		
			window.onbeforeunload = function(){
				if(sessionStorage.getItem('username') || localStorage.getItem('username'))
					localStorage.setItem('last_seen', Math.round((new Date()).getTime() / 1000));
			};
		</script>
	</head>
	<body class="is-preload">
		<!-- Header -->
		<header id="header" class="alt">
			<div class="logo" style="margin-top: -25px">
				<noselect>
					<a href="index.html"><img src="images/logo.png" height="45px" style="vertical-align: middle"> Dexata</a> &nbsp; 
					<a href="search.html" title='search'><i class="fas fa-search fa-1x" style="vertical-align:middle"></i></a> 
					<a href="config.html" title='config'><i class="fas fa-cogs fa-1x" style="vertical-align:middle"></i></a> 
					<a href="manage_users.html" title='manage users'><i class="fas fa-user-cog fa-1x" style="vertical-align:middle"></i></a> 
				</noselect>
			</div>
		
			<nav id="nav">
				<ul>
					<li><a href="index.html">home</a></li>
					<li><a href="coins.html">coins</a></li>
					<li><a href="charts.html">charts</a></li>
					<li><a href="news.html">news</a></li>
					<li><a href="scams.html">scams</a></li>
					<li><a href="watchlist.html">watchlist</a></li>
					<li><a href="wallet.html">wallet</a></li>
					<li id="login_menu_item"></li>
				</ul>
			</nav>
		</header>

		<!-- Wrapper -->
		<div id="wrapper">
			<!-- One -->
			<section id="one" class="wrapper style1">
				<div class="inner">
					<div class="spotlights">
						<center>
							<div id="title_spotlight" class="spotlight" style="max-width:100%; margin-bottom: 20px">
								<div id="title_div" class="content">
									<h1 id="coin_title" style="margin-top: 5px"></h1>
									<noselect>
										<p style="margin-top:0px; margin-bottom: 0px" id="coin_links"></p>
										<p style="margin-top:5px; margin-bottom: 0px" id="other_links"></p>
										<div id="watching_div" style="max-width: 100%; margin-top: 0px">
										</div>
									</noselect>
								</div>
							</div>
							<div id="contract_spotlight" class="spotlight" style="max-width: 100%; display: none; margin-bottom: 20px;">
								<div id="contract_table_div" class="xscroll" style="max-width: 100%">
									<table id="contract_table" style="text-align:center">
										<tr>
											<td></td>
											<td><b>contract</b></td>
											<td></td>
										</tr>
									</table>
								</div>
							</div>
							<div id="page_div">
								<div id="data_table_spotlight" class="spotlight" style="width: 350px; max-width: 100%; display:inline-block; margin-bottom: 20px; vertical-align: top;">
									<div id="data_table_div" class="xscroll">
										<table id="data_table" style="text-align:right">
											<tr>
												<td><b>price:</b></td>
												<td></td>
											</tr>
											<tr>
												<td><b>market cap:</b></td>
												<td></td>
											</tr>
											<tr>
												<td><b>undiluted<br>market cap:</b></td>
												<td></td>
											</tr>
											<tr>
												<td><b>volume:</b></td>
												<td></td>
											</tr>
											<tr>
												<td><b>total supply:</b></td>
												<td></td>
											</tr>
											<tr>
												<td><b>max supply:</b></td>
												<td></td>
											</tr>
											<tr>
												<td><b>circulating supply:</b></td>
												<td></td>
											</tr>
										</table>
									</div>
								</div>
								<div id="rhs_table_div" style="max-width: 100%; display:inline-block; vertical-align: top;">
									<div id="change_table_spotlight" class="spotlight" style="width: 600px; max-width: 100%; margin-bottom: 20px">
											<div id="change_table_div" class="xscroll">
												<table id="change_table" style="text-align:center">
													<thead>
														<tr>
															<td>hour</td>
															<td>day</td>
															<td>week</td>
															<td>month</td>
															<td>year</td>
														</tr>
													</thead>
													<tr>
														<td></td>
														<td></td>
														<td></td>
														<td></td>
														<td></td>
													</tr>
												</table>
											</div>
									</div>
									<div id="at_table_spotlight" class="spotlight" style="width: 600px; max-width: 100%;">
											<div id="at_table_div" class="xscroll">
												<table id="at_table" style="text-align:center">
													<thead>
														<tr>
															<td></td>
															<td>price</td>
															<td>change</td>
															<td>date</td>
															<td>days</td>
														</tr>
													</thead>
													<tr>
														<td><b>low</b></td>
														<td></td>
														<td></td>
														<td></td>
														<td></td>
													</tr>
													<tr>
														<td><b>high</b></td>
														<td></td>
														<td></td>
														<td></td>
														<td></td>
													</tr>
												</table>
											</div>
									</div>
								</div>
		
								<select name="chart_range" id="chart_range" style="width:130px; margin-top: 0px; margin-bottom: 10px" onchange="change_chart_range()">
									<option value="hour">hour</option>
									<option value="day">day</option>
									<option value="week">week</option>
									<option value="month">month</option>
									<option value="year">year</option>
									<option value="max">max</option>
								</select>
								<div id="prices_chart_spotlight" class="spotlight" style="width: 100%; overflow: hidden">
									<div id="prices_chart" style="min-width: 200px; width: 90%; padding-top: 30px; padding-bottom:30px; margin: 0 auto">
									</div><br>
								</div>
								<div id="total_volumes_chart_spotlight" class="spotlight" style="width: 100%; overflow: hidden">
									<div id="total_volumes_chart" style="min-width: 200px; width: 90%; padding-top: 30px; padding-bottom:30px; margin: 0 auto">
									</div><br>
								</div>
							</div>
							<div id="exchange_spotlight" class="spotlight" style="max-width: 100%; max-height: 230px; overflow-y: scroll; margin-bottom: 30px; margin-top: 20px">
								<div id="exchange_table_div" class="xscroll" style="max-width: 100%">
									<table id="exchange_table" style="text-align:center">
										<tr>
											<td></td>
											<td><b>exchange</b></td>
											<td><b>pair</b></td>
											<td><b>price</b></td>
											<td><b>24h volume</b></td>
											<td><b>trust</b></td>
										</tr>
									</table>
								</div>
							</div>
							<div id="desc_spotlight" class="spotlight" style="max-width: 100%; display: inline-block; margin-bottom: 10px;">
							</div><br>
		
							<div id="newsfeed_div" style="max-height: 350px; overflow-y: scroll; background-color: #2E2E35; border-radius: 5px; scrollbar-color: grey #2e2e35;">
							</div>
		
							<div id="last_updated" style="max-width: 100%; display: inline-block; margin-bottom: -50px; margin-top: 15px">
							</div>
						</center>
					</div>
		
				</div>
			</section>
		</div>
		
		
		
		<script>
			var details_filled = 0;
			var refresh_ms = 60000;
			var chart_range = "hour";
			var chart_freq = "minute";
			var price_chart, vol_chart;
		
			var watchlist_name;
			var watchlist;
			var watching;
		
			if(localStorage.getItem(user + '-refresh_sec'))
				refresh_ms = 1000*localStorage.getItem(user + '-refresh_sec');
			else
				localStorage.setItem(user + '-refresh_sec', 60);
		
			if(localStorage.getItem(user + '-chart_freq'))
				chart_freq = localStorage.getItem(user + '-chart_freq');
			else
				localStorage.setItem(user + '-chart_freq', 'minute');
		
			if(localStorage.getItem(user + '-chart_range'))
				chart_range = localStorage.getItem(user + '-chart_range');
			else
				localStorage.setItem(user + '-chart_range', 'hour');
		
			document.getElementById('chart_range').value = chart_range;
		
			function treatAsUTC(date)
			{
			    var result = new Date(date);
			    result.setMinutes(result.getMinutes() - result.getTimezoneOffset());
			    return result;
			}
		
			var millisecondsPerDay = 24 * 60 * 60 * 1000;
			function daysSince(date)
			{   
			    return Math.round((treatAsUTC(new Date()) - treatAsUTC(date)) / millisecondsPerDay);
			}
		
			function draw_chart(title, chart_type, y_title, data)
			{
				var options = {
			      series: [{
				      name: y_title,
				      data: data
				  }],
			      chart: {
				      type: 'area',
				      stacked: false,
				      background: 'none',
				      height: 350,
				      zoom: {
				        type: 'xy',
				        enabled: true,
				      },
				      toolbar: {
				        autoSelected: 'zoom'
				      }
				    },
				  colors:['#C600EB', '#E91E63', '#9C27B0'],
				  dataLabels: {
				      enabled: false
				  },
				  markers: {
				    size: 0,
				  },
				  title: {
				    text: title,
				    align: 'left',
				    textColor: '#ff1493',
				  },
				  fill: {
				    type: 'gradient',
				    gradient: {
				      shadeIntensity: 0.4,
				      inverseColors: false,
				      opacityFrom: 0.8,
				      opacityTo: 0.4,
				      stops: [0, 90, 100]
				    },
				  },
				  yaxis: {
				    labels: {
				      formatter: function (val) {
				        if(val == 0)
				        	return 0;
				        else if(val >= 1)
				        	return val.toLocaleString('en');
				        else if(val > 0 && val < 0.001)
				        	return val.toExponential(3);
				        else
				        	return val.toFixed(5);
				      },
				    },
				    tickAmount: 4,
				    title: {
				      text: y_title,
				    },
				  },
				  xaxis: {
				    type: 'datetime',
			        tickAmount: 5,
				    labels: {
				      formatter: function (val) {
				        if(chart_range == "hour" || chart_range == "day")
					    	return new Date(val).toLocaleTimeString();
					    else
					    	return new Date(val).toLocaleDateString();
				      },
				    },
				  },
				  theme: {
				  	mode: 'dark',
				  },
				  stroke: {
				   width: 2,    
				  },
				  tooltip: {
				    shared: false,
				    y: {
				      formatter: function (val) {
				        if(val == 0)
				        	return 0;
				        else if(val >= 1)
				        	return val.toLocaleString('en');
				        else if(val > 0 && val < 0.001)
				        	return val.toExponential(3);
				        else
				        	return val.toFixed(5);
				      }
				    }
				  }
			    };
		
			    var chart = new ApexCharts(document.querySelector("#" + chart_type + "_chart"), options);
			    chart.render();
			    return chart;
			}
		
			function fetch_chart(chart_type, y_title, coin_data)
			{
				var data_range;
		
				if(chart_range == "hour")
					data_range = 0.041666667;
				else if(chart_range == "day")
					data_range = 1;
				else if(chart_range == "week")
					data_range = 7;
				else if(chart_range == "month")
					data_range = 30;
				else if(chart_range == "year")
					data_range = 365;
				else if(chart_range == "max")
					data_range = "max";
		
				$(document).ready(function(){
					//alert('https://api.coingecko.com/api/v3/coins/' + coin_data['id'] + '/market_chart?vs_currency=usd&days=' + data_range + '&interval=' + chart_freq);
					$.get(
						'https://api.coingecko.com/api/v3/coins/' + coin_data['id'] + '/market_chart?vs_currency=usd&days=' + data_range + '&interval=' + chart_freq,
						function(data) {
							if(chart_type == "prices")
							{
								if(price_chart != undefined)
								{
									price_chart.destroy();
									document.getElementById('prices_chart').innerHTML = "";
								}
								price_chart = draw_chart(coin_data['name'], chart_type, y_title, data[chart_type]);
		
								document.getElementById('prices_chart_spotlight').style.height = (document.getElementById('prices_chart').offsetHeight + 10) + "px";
							}
							else
							{
								if(vol_chart != undefined)
								{
									vol_chart.destroy();
									document.getElementById('total_volumes_chart').innerHTML = "";
								}
								vol_chart = draw_chart(coin_data['name'], chart_type, y_title, data[chart_type]);
		
		
								document.getElementById('total_volumes_chart_spotlight').style.height = (document.getElementById('total_volumes_chart').offsetHeight + 10) + "px";
							}
					}).fail(function() {
						clear_page();
						document.getElementById("page_div").innerHTML = "<p>could not find " + param_map.get('contract_address') + " on the " + param_map.get('network') + " network</p>";
					});
				});
			}
		
			function clear_page()
			{
				document.getElementById("coin_title").innerHTML = '<img src="images/logo.png" height="225px" style="vertical-align: middle";><noselect> Dexata</noselect>';
		
				document.getElementById("page_div").innerHTML = "";
			}
		
			function ctrl_c(val)
			{
				var textArea = document.createElement("textarea");
				textArea.value = val;
		
				textArea.style.position = "fixed";
				textArea.style.bottom = "-30px";
				textArea.style.right = "-30px";
				textArea.style.width = "0px";
				textArea.style.height = "0px";
		
				document.body.appendChild(textArea);
				textArea.select();
				textArea.setSelectionRange(0, 99999); /*For mobile devices*/
				document.execCommand("copy");
				textArea.style.visibility = "hidden";
			}
		
			function toggle_watching(id)
			{
				if(watching[id] == true)
				{
					document.getElementById('watchlist_icon').innerHTML = "<i class='fas fa-eye fa-2x'></i>";
					unwatch(user, watchlist, watchlist_name, id);
				}
				else
				{
					document.getElementById('watchlist_icon').innerHTML = "<i class='fas fa-eye-slash fa-2x''></i>";
					watch(user, watchlist, watchlist_name, id);
				}
				watchlist = fetch_watchlist(user, watchlist_name);
				watching = fetch_map(user, watchlist);
			}
		
			function fill_details(data)
			{
				document.title = "Dexata - " + data['symbol'];
		
				if(data['image']['large'] != "")
					document.getElementById("coin_title").innerHTML = '<img onerror="this.src=\'images/missing.png\'" class="rounded" src="' + data['image']['large'] + '" height="150px" style="vertical-align: middle";><br>' + data['name'] + ' (' + data['symbol'] + ')';
		
				document.getElementById("coin_links").innerHTML = "";
		
				if(data['links']['homepage'][0] != "")
					document.getElementById("coin_links").innerHTML += '<a href="' + data['links']['homepage'][0] + '"><i class="fas fa-home fa-2x"></i></a></a>';
		
				if(data['links']['telegram_channel_identifier'] != "")
					document.getElementById("coin_links").innerHTML += '&nbsp;&nbsp;<a href="https://t.me/' + data['links']['telegram_channel_identifier'] + '"><i class="icon brands fa-telegram fa-2x"></i></a>';
		
				if(data['links']['twitter_screen_name'] != "")
					document.getElementById("coin_links").innerHTML += '&nbsp;&nbsp;<a href="https://twitter.com/' + data['links']['twitter_screen_name'] + '"><i class="icon brands fa-twitter fa-2x"></a>';
		
				if(data['links']['chat_url'][0] != "")
					document.getElementById("coin_links").innerHTML += '&nbsp;&nbsp;<a href="' + data['links']['chat_url'][0] + '"><i class="fas fa-comments fa-2x"></i></a>';
		
		
				if(data['platforms']['binance-smart-chain'] != undefined)
				{
					document.getElementById("other_links").innerHTML += '<a href="https://bscscan.com/token/' + data['platforms']['binance-smart-chain'] + '"><img src="images/icons/bscscan.png" height="30px"></a>';
					document.getElementById("other_links").innerHTML += '&nbsp;&nbsp;&nbsp;<a href="https://poocoin.app/tokens/' + data['contract_address'] + '"><img src="images/logos/poocoin-poocoin.svg" height="30px"></a>';
				}
		
				if(data['platforms']['ethereum'] != undefined)
				{
					document.getElementById("other_links").innerHTML += '&nbsp;&nbsp;&nbsp;<a href="https://etherscan.io/token/' + data['platforms']['ethereum'] + '"><img src="images/icons/etherscan.svg" height="30px"></a>';
					document.getElementById("other_links").innerHTML += '&nbsp;&nbsp;<a href="https://ethplorer.io/address/' + data['platforms']['ethereum'] + '"><img src="images/icons/ethplorer.png" height="30px"></a>';
				}
		
				if(data['platforms']['polygon-pos'] != undefined)
					document.getElementById("other_links").innerHTML += '&nbsp;&nbsp;<a href="https://polygonscan.com/token/' + data['platforms']['polygon-pos'] + '"><img src="images/icons/polygonscan.png" height="30px"></a>';
		
				document.getElementById('title_spotlight').style.width = (document.getElementById('title_div').offsetWidth + 70) + "px";
		
				if(data['contract_address'] != undefined && data['contract_address'].length > 10)
				{
					if(data['platforms'] != undefined)
					{
						document.getElementById('contract_spotlight').style.display = "inline-block";
		
						var table = document.getElementById('contract_table');
		
						var r = 1;
						for(let p in data['platforms'])
						{
							var row = table.insertRow(r++);
		
							row.insertCell(0).innerHTML = "<img src='images/icons/" + p + ".svg' style='min-width: 20px; max-height: 20px; vertical-align: middle' onerror='this.style.display=\"none\"'>";
		
							var cell = row.insertCell(1);
							cell.innerHTML = data['platforms'][p];
							cell.setAttribute('title', p);
		
							row.insertCell(2).innerHTML = "<a onclick=\"ctrl_c(\'" + data['platforms'][p] + "\')\"><i class='fas fa-copy fa-1x' style='vertical-align:middle; margin-left: 10px'></i></a>";
						}
					}
					else
					{
						var row = table.insertRow(1);
		
						row.insertCell(1).innerHTML = data['contract_address'];
		
						row.insertCell(2).innerHTML = "<a onclick=\"ctrl_c(\'" + data['contract_address'] + "\')\"><i class='fas fa-copy fa-1x' style='vertical-align:middle'></i></a>";
					}
		
					document.getElementById('contract_spotlight').style.width = document.getElementById('title_spotlight').style.width = (document.getElementById('contract_table').offsetWidth + 70) + "px";
				}
		
				if(data['tickers'] != undefined)
				{
					document.getElementById('exchange_spotlight').style.display = "block";
		
					for(var r=0; r<data['tickers'].length; r++)
					{
						if(data['tickers'][r]['market']['name'] != undefined)
						{
							var row = document.getElementById('exchange_table').insertRow(r+1);
		
							row.insertCell(0).innerHTML = "<img src='images/exchanges/" + data['tickers'][r]['market']['identifier'] + ".svg' style='min-width: 23px; max-height: 23px; vertical-align: middle' onerror='this.style.display=\"none\"'>";
		
							row.insertCell(1).innerHTML = data['tickers'][r]['market']['name'];
		
							row.insertCell(2).innerHTML = "<a href='" + data['tickers'][r]['trade_url'] + "'>" + data['tickers'][r]['coin_id'] + "/" + data['tickers'][r]['target_coin_id'] + "</a>";
		
							row.insertCell(3).innerHTML = "$" + data['tickers'][r]['converted_last']['usd'];
		
							row.insertCell(4).innerHTML = "$" + data['tickers'][r]['converted_volume']['usd'].toLocaleString();
		
							if(data['tickers'][r]['trust_score'] == "green")
								row.insertCell(5).innerHTML = "<green><i class='fas fa-circle fa-1x' style='vertical-align:middle'></i></green>";
							else
								row.insertCell(5).innerHTML = "<red><i class='fas fa-circle fa-1x' style='vertical-align:middle'></i></red>";
						}
					}
		
					document.getElementById('exchange_spotlight').style.width = (document.getElementById('exchange_table_div').offsetWidth + 250) + "px";
				}
		
				if(watching[data['id']] == undefined)
					document.getElementById("watching_div").innerHTML += "<p style='margin-top: 10px; margin-bottom: 0px'><a id='watchlist_icon' onclick='toggle_watching(\"" + data['id'] + "\")'><i class='fas fa-eye fa-2x'></i></a></p>";
				else
					document.getElementById("watching_div").innerHTML += "<p style='margin-top: 10px; margin-bottom: 0px'><a id='watchlist_icon' onclick='toggle_watching(\"" + data['id'] + "\")'><i class='fas fa-eye-slash fa-2x'></i></a></p>";
		
				if(data['description']['en'] != undefined && 
					data['description']['en'] != "")
					document.getElementById('desc_spotlight').innerHTML = "<h3 style='margin-top: 15px; margin-bottom: 10px'>About</h3><center><p style='max-width: 90%; margin-top: 10px; margin-bottom: 20px'>" + data['description']['en'] + "</p></center>";
				else
					document.getElementById('desc_spotlight').style.display = "none";
		
				document.getElementById('newsfeed_div').innerHTML = 
				'<iframe id="newsfeed_iframe" scrolling="no" width="100%" height="650px" allowtransparency="true" frameborder="0" src="https://cryptopanic.com/widgets/news/?bg_color=2E2E35&amp;currencies=' + data['symbol'] + '&amp;font_family=sans&amp;header_bg_color=30343B&amp;header_text_color=FFFFFF&amp;link_color=679267&amp;news_feed=recent&amp;posts_limit=10&amp;text_color=FFFFFF&amp;title=News"></iframe>';
		
				var body_width = document.body.clientWidth;
				if(body_width < 530)
					document.getElementById('newsfeed_iframe').style.height = "1000px";
				else if(body_width < 700)
					document.getElementById('newsfeed_iframe').style.height = "900px";
				else if(body_width < 950)
					document.getElementById('newsfeed_iframe').style.height = "800px";
				else if(body_width < 1100)
					document.getElementById('newsfeed_iframe').style.height = "700px";
			}
		
			function fill_data(data)
			{
				var table = document.getElementById("data_table");
		
				if(data['market_data']['current_price']['usd'] == 0)
					table.rows[0].cells[1].innerHTML = "-";
				else if(data['market_data']['current_price']['usd'] > 999)
					table.rows[0].cells[1].innerHTML = "$" + data['market_data']['current_price']['usd'].toLocaleString('en');
				else if(data['market_data']['current_price']['usd'] < 0.001)
					table.rows[0].cells[1].innerHTML = "$" + data['market_data']['current_price']['usd'].toExponential(3);
				else
					table.rows[0].cells[1].innerHTML = "$" + data['market_data']['current_price']['usd'].toFixed(5);
		
				if(data['market_data']['market_cap']['usd'] > 0)
					table.rows[1].cells[1].innerHTML = "$" + data['market_data']['market_cap']['usd'].toLocaleString('en');
				else
					table.rows[1].cells[1].innerHTML = '-';
		
				if(data['market_data']['current_price']['usd'] > 0 &&
					data['market_data']['total_supply'])
					table.rows[2].cells[1].innerHTML = "$" + (data['market_data']['current_price']['usd']*data['market_data']['total_supply']).toLocaleString('en');
				else
					table.rows[2].cells[1].innerHTML = '-';
		
				if(data['market_data']['market_cap']['usd'] > 0)
					table.rows[3].cells[1].innerHTML = "$" + data['market_data']['total_volume']['usd'].toLocaleString('en');
				else
					table.rows[3].cells[1].innerHTML = '-';
		
				if(data['market_data']['total_supply'] > 0)
					table.rows[4].cells[1].innerHTML = data['market_data']['total_supply'].toLocaleString('en');
				else
					table.rows[4].cells[1].innerHTML = '-';
		
				if(data['market_data']['max_supply'] > 0)
					table.rows[5].cells[1].innerHTML = data['market_data']['max_supply'].toLocaleString('en');
				else
					table.rows[5].cells[1].innerHTML = '-';
		
				if(data['market_data']['circulating_supply'] > 0)
					table.rows[6].cells[1].innerHTML = data['market_data']['circulating_supply'].toLocaleString('en');
				else
					table.rows[6].cells[1].innerHTML = '-';
		
				table = document.getElementById("change_table");
		
				if(data['market_data']['price_change_percentage_1h_in_currency']['usd'] == undefined)
					table.rows[1].cells[0].innerHTML = "-";
				else if(data['market_data']['price_change_percentage_1h_in_currency']['usd'] >= 0)
					table.rows[1].cells[0].innerHTML = "<green>" + data['market_data']['price_change_percentage_1h_in_currency']['usd'].toLocaleString('en') + "%</green>";
				else
					table.rows[1].cells[0].innerHTML = "<red>" + data['market_data']['price_change_percentage_1h_in_currency']['usd'].toLocaleString('en') + "%</red>";
		
				if(data['market_data']['price_change_percentage_24h_in_currency']['usd'] == undefined)
					table.rows[1].cells[1].innerHTML = "-";
				else if(data['market_data']['price_change_percentage_24h_in_currency']['usd'] >= 0)
					table.rows[1].cells[1].innerHTML = "<green>" + data['market_data']['price_change_percentage_24h_in_currency']['usd'].toLocaleString('en') + "%</green>";
				else
					table.rows[1].cells[1].innerHTML = "<red>" + data['market_data']['price_change_percentage_24h_in_currency']['usd'].toLocaleString('en') + "%</red>";
		
				if(data['market_data']['price_change_percentage_7d_in_currency']['usd'] == undefined)
					table.rows[1].cells[2].innerHTML = "-";
				else if(data['market_data']['price_change_percentage_7d_in_currency']['usd'] >= 0)
					table.rows[1].cells[2].innerHTML = "<green>" + data['market_data']['price_change_percentage_7d_in_currency']['usd'].toLocaleString('en') + "%</green>";
				else
					table.rows[1].cells[2].innerHTML = "<red>" + data['market_data']['price_change_percentage_7d_in_currency']['usd'].toLocaleString('en') + "%</red>";
		
				if(data['market_data']['price_change_percentage_30d_in_currency']['usd'] == undefined)
					table.rows[1].cells[3].innerHTML = "-";
				else if(data['market_data']['price_change_percentage_30d_in_currency']['usd'] >= 0)
					table.rows[1].cells[3].innerHTML = "<green>" + data['market_data']['price_change_percentage_30d_in_currency']['usd'].toLocaleString('en') + "%</green>";
				else
					table.rows[1].cells[3].innerHTML = "<red>" + data['market_data']['price_change_percentage_30d_in_currency']['usd'].toLocaleString('en') + "%</red>";
		
				if(data['market_data']['price_change_percentage_1y_in_currency']['usd'] == undefined)
					table.rows[1].cells[4].innerHTML = "-";
				else if(data['market_data']['price_change_percentage_1y_in_currency']['usd'] >= 0)
					table.rows[1].cells[4].innerHTML = "<green>" + data['market_data']['price_change_percentage_1y_in_currency']['usd'].toLocaleString('en') + "%</green>";
				else
					table.rows[1].cells[4].innerHTML = "<red>" + data['market_data']['price_change_percentage_1y_in_currency']['usd'].toLocaleString('en') + "%</red>";
		
				table = document.getElementById('at_table');
		
				if(data['market_data']['atl']['usd'] == undefined)
					table.rows[1].cells[1].innerHTML = "-";
				/*else if(data['market_data']['atl']['usd'] > 0 && data['market_data']['atl']['usd'] < 0.001)
					table.rows[1].cells[1].innerHTML = "$" + data['market_data']['atl']['usd'].toExponential(3);*/
				else
					table.rows[1].cells[1].innerHTML = "$" + data['market_data']['atl']['usd'];
		
				if(data['market_data']['ath']['usd'] == undefined)
					table.rows[2].cells[1].innerHTML = "-";
				/*else if(data['market_data']['ath']['usd'] > 0 && data['market_data']['ath']['usd'] < 0.001)
					table.rows[2].cells[1].innerHTML = "$" + data['market_data']['ath']['usd'].toExponential(3);*/
				else
					table.rows[2].cells[1].innerHTML = "$" + data['market_data']['ath']['usd'];
		
				if(data['market_data']['atl_change_percentage']['usd'] == undefined)
					table.rows[1].cells[2].innerHTML = "-";
				else if(data['market_data']['atl_change_percentage']['usd'] >= 0)
					table.rows[1].cells[2].innerHTML = "<green>" + data['market_data']['atl_change_percentage']['usd'].toLocaleString('en') + "%</green>";
				else
					table.rows[1].cells[2].innerHTML = "<red>" + data['market_data']['atl_change_percentage']['usd'].toLocaleString('en') + "%</red>";
		
				if(data['market_data']['ath_change_percentage']['usd'] == undefined)
					table.rows[2].cells[2].innerHTML = "-";
				else if(data['market_data']['ath_change_percentage']['usd'] >= 0)
					table.rows[2].cells[2].innerHTML = "<green>" + data['market_data']['ath_change_percentage']['usd'].toLocaleString('en') + "%</green>";
				else
					table.rows[2].cells[2].innerHTML = "<red>" + data['market_data']['ath_change_percentage']['usd'].toLocaleString('en') + "%</red>";
		
				if(data['market_data']['atl_date']['usd'] == undefined)
					table.rows[1].cells[3].innerHTML = "-";
				else
				{
					table.rows[1].cells[3].innerHTML = new Date(data['market_data']['atl_date']['usd']).toLocaleDateString();
					table.rows[1].cells[4].innerHTML = daysSince(data['market_data']['atl_date']['usd']);
				}
		
				if(data['market_data']['ath_date']['usd'] == undefined)
					table.rows[2].cells[3].innerHTML = "-";
				else
				{
					table.rows[2].cells[3].innerHTML = new Date(data['market_data']['ath_date']['usd']).toLocaleDateString();
					table.rows[2].cells[4].innerHTML = daysSince(data['market_data']['ath_date']['usd']);
				}
		
				if(data['last_updated'] != undefined)
					document.getElementById('last_updated').innerHTML = "<p><b>data last updated</b><br>" + new Date(data['last_updated']).toLocaleTimeString() + " " + new Date(data['last_updated']).toLocaleDateString() + "</p>";
			}
		
			function fetch_info_from_contract_address()
			{
				$(document).ready(function(){
					$.get(
			    	    'https://api.coingecko.com/api/v3/coins/' + param_map.get('network') + '/contract/' + param_map.get('contract_address'),              
						function(data) {
							if(!details_filled)
							{
								details_filled = 1;
								fill_details(data);
							}
							fill_data(data);
							fetch_chart("prices", "Price", data);
							fetch_chart("total_volumes", "Volume", data);
					}).fail(function() {
						clear_page();
						document.getElementById("page_div").innerHTML = "<p>could not find " + param_map.get('contract_address') + " on the " + param_map.get('network') + " network</p>";
					});
				});
			}
		
			function fetch_info_from_id()
			{
				$(document).ready(function(){
					$.get(
			    	    'https://api.coingecko.com/api/v3/coins/' + param_map.get('id'),              
						function(data) {
							if(!details_filled)
							{
								details_filled = 1;
								fill_details(data);
							}
							fill_data(data);
							fetch_chart("prices", "Price", data);
							fetch_chart("total_volumes", "Volume", data);
					}).fail(function(){ 
						clear_page();
						document.getElementById("page_div").innerHTML = "<p>could not find " + param_map.get('id') + "</p>";
					});
				});
			}
		
			function fetch_info()
			{
				if(param_map.get('contract_address') != undefined && param_map.get('network') != undefined)
				{
					fetch_info_from_contract_address();
				}
				else if(param_map.get('id') != undefined)
				{
					fetch_info_from_id();
				}
				else
				{
					clear_page();
		
					document.getElementById("page_div").innerHTML = "<p>please specify a coin name or alternatively a contract address along with a network</p>";
				}
			}
		
			function change_chart_range()
			{
				chart_range = document.getElementById('chart_range').value;
				localStorage.setItem(user + '-chart_range', chart_range);
				
				if(chart_range == "hour")
					chart_freq = "minute";
				else if(chart_range == "day" || chart_range == "week")
					chart_freq = "hourly";
				else if(chart_range == "month" || chart_range == "year" || chart_range == "max")
					chart_freq = "daily";
		
				localStorage.setItem(user + '-chart_freq', chart_freq);
		
				fetch_info();
			}
		
			function refresh_data()
			{
				if(refresh_ms > 0)
					sleep(refresh_ms).then(() => { fetch_info(); refresh_data(); });
			}
		
			watchlist_name = localStorage.getItem(user + "-watchlist");
			watchlist = fetch_watchlist(user, watchlist_name);
			watching = fetch_map(watchlist);
		
		
			fetch_info();
			document.getElementById('data_table_spotlight').style.width = (document.getElementById('data_table').offsetWidth + 60) + "px";
			document.getElementById('exchange_spotlight').style.width = (document.getElementById('exchange_table_div').offsetWidth + 200) + "px";
			var max_width = Math.max(document.getElementById('change_table').offsetWidth, document.getElementById('at_table').offsetWidth);
			document.getElementById('change_table_spotlight').style.width = (max_width + 170) + "px";
			document.getElementById('at_table_spotlight').style.width = (max_width + 170) + "px";
			document.getElementById('rhs_table_div').style.width = (max_width + 190) + "px";
			refresh_data();
			
		</script>

		<!-- Footer -->
		<div class="footer wrapper">
			<div class="inner" style="text-align:center">
				<noselect>
					<p>
						<a href="search.html" title='search'><i class="fas fa-search fa-2x"></i></a> &nbsp;
						<a href="coins.html" title='coins'><i class="fas fa-coins fa-2x"></i></a> &nbsp;
						<a href="charts.html" title='charts'><i class="fas fa-chart-area fa-2x"></i></a> &nbsp;
						<a href="news.html" title='news'><i class="fas fa-newspaper fa-2x"></i></a> &nbsp;
						<a href="scams.html" title='scams'><i class="fas fa-bomb fa-2x"></i></a> &nbsp;
						<a href="watchlist.html" title='watchlist'><i class="fas fa-binoculars fa-2x"></i></a> &nbsp;
						<a href="wallet.html" title='wallet tracker'><i class="fas fa-wallet fa-2x"></i></a><br>
						
						<a href="https://t.me/dexata_army" title='telegram'><i class="icon brands fa-telegram fa-2x"></i></a> &nbsp;
						<a href="https://twitter.com/dexata_army" title='twitter'><i class="icon brands fa-twitter fa-2x"></i></a> &nbsp;
						<a href="https://github.com/dexata-army" title='github'><i class="icon brands fa-github fa-2x"></i></a> &nbsp;
						<a href="config.html" title='config'><i class="fas fa-cogs fa-2x"></i></a> &nbsp;
						<a href="manage_users.html" title='manage users'><i class="fas fa-user-cog fa-2x"></i></a> &nbsp;
						<text id="login_footer_item" style="display: inline-block"><a href="login.html" title='login'><i class="fas fa-sign-in-alt fa-2x"></i></a></text>
					</p>
		
					<p>
						<input id="footer_search_box" placeholder="search">
					</p>
		
					<p class="copyright">
						&copy;<script>document.write(new Date().getFullYear())</script> Dexata
					</p>
				</noselect>
			</div>
		</div>
		
		<script>
			window.addEventListener('keydown',this.keydown,false);
		
			function keydown(e)
			{
				var code = e.keyCode;
				
				if(document.activeElement.tagName == "INPUT")
				{
					if(code == 13)
					{
						if(document.activeElement.id == "footer_search_box" &&
							document.getElementById('footer_search_box').value != "")
						{
							window.location.href = "search.html?term=" + document.getElementById('footer_search_box').value;
						}
					}
				}
			}
		</script>

		<script>
			//changes login to logout on page if logged in
			if(localStorage.getItem("username"))
			{
				//document.getElementById('login_menu_item').innerHTML = "<a onclick='logout()'>logout</a>";
				//document.getElementById('login_footer_item').innerHTML = "<a onclick='logout()' title='logout'><i class='fas fa-sign-out-alt fa-2x'></i></a>";
				document.getElementById('login_menu_item').innerHTML = "<a href='logout.html?return_to=" + window.location.href.substring(window.location.href.lastIndexOf('/') + 1) + "'>logout</a>"
				document.getElementById('login_footer_item').innerHTML = "<a href='logout.html?return_to=" + window.location.href.substring(window.location.href.lastIndexOf('/') + 1) + "'><i class='fas fa-sign-out-alt fa-2x'></i></a>"
			}
			else
			{
				document.getElementById('login_menu_item').innerHTML = "<a href='login.html?return_to=" + window.location.href.substring(window.location.href.lastIndexOf('/') + 1) + "'>login</a>"
				document.getElementById('login_footer_item').innerHTML = "<a href='login.html?return_to=" + window.location.href.substring(window.location.href.lastIndexOf('/') + 1) + "'><i class='fas fa-sign-in-alt fa-2x'></i></a>"
			}
		
			//prevent autocomplete
			$(':input').on('focus', function () {
				$(this).attr('autocomplete', 'off')
			});
		</script>

		<script src="assets/js/browser.min.js"></script>
		<script src="assets/js/breakpoints.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>
	</body>
</html>
